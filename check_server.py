# ANBU :: TCP Session Hunter Module: Server Discovery
# Author: St0rn
# 
#
#!usr/bin/env/python

import os
from scapy import *

ip = []
port = []

def check_interest_server(a):
  if a[IP].src not in ip or a[TCP].sport not in port:
   ip.append(a[IP].src)
   port.append(a[TCP].sport)
   if a[TCP].sport == 21:
     print "[+] " + a[IP].src + " Is a FTP Server on Port 21"
   elif a[TCP].sport == 22:
     print "[+] " + a[IP].src + " Is a SSH Server on port 22"
   elif a[TCP].sport == 23:
     print "[+] " + a[IP].src + " Is a Telnet Server on port 23"
   elif a[TCP].sport == 513:
     print "[+] " + a[IP].src + " Is a Rlogin Server on port 513"
   elif a[TCP].sport == 3306:
     print "[+] " + a[IP].src + " Is a MySQL Server on port 3306"

os.system("clear")
print "-> Server Discovery\n"
print " "
sniff(count=0, prn = lambda a : check_interest_server(a), lfilter=lambda(f): f.haslayer(TCP) and f.haslayer(IP))

