#!/usr/bin/env python
#Author: Storn
#
#Find all client connected per Access Point with AP Probe Response
#
#Use Scapy
#
#argv[1] = Monitor Interface
#

import os
import sys
from scapy.all import *

os.system("clear")

if len(sys.argv) < 2:
 print "\n" + sys.argv[0] + " <Monitor Iface>\n"
 sys.exit()
else:
 device = sys.argv[1]
 addr_list = []

 print "\n |    Client Mac    |    AP SSID    |"     

 def client_discover(p):
  if p.haslayer(Dot11) and p.haslayer(Dot11ProbeResp):
    if p.addr1 not in addr_list:
      addr_list.append(p.addr1)
      print "\n  " + p.addr1 + " |    " + p.info

 try:
  sniff(iface = device, count = 0, prn = client_discover) 
 except:
  print "\n[-] Can't Launch Sniffer...\n"
  sys.exit()
