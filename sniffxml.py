#!/usr/bin/env python
#
# sniffXML.py is a part of upnpHax.py
#
#Author:   St0rn
#Website:  anbu-pentest.com
#
#

from scapy.all import *
from os import system

## Sniff NOTIFY packet to get some UPnP device XML Configuration url ##
def sniffXML():
  def upnp_sniff(p):
   if p.haslayer(UDP) and p.haslayer(Raw):
    if p[UDP].dport == 1900:
     if "NOTIFY *" in p[Raw].load:
      print "\n\n"+p[Raw].load
  try:
   sniff(prn=upnp_sniff, filter="udp")
  except:
   print "\n[-] Can't launch sniffer :/\n"

system("/usr/bin/clear")
print "\n[*] Waiting for XML configuration URL\n\n"
sniffXML()
