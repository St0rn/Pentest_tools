

#!usr/env python
import sys
import os
import socket
import errno
from socket import error as socket_error

ports = []

os.system("clear")

print "\033[94m"
port_dep = int(raw_input("Port Depart: "))
port_fin = int(raw_input("Port Fin: "))
print "\033[0m"

os.system("clear")
print "\n                  ------------------------------------------"
print "                  |                \033[91mFireEnum\033[0m                |\n                  |                                        |\n                  | Post-Exploitation Filtred Ports Finder |\n                  | Author: St0rn for OSCP                 |\n                  | Site:   anbu-pentest.com               |"
print "                  ------------------------------------------\n\n"


for p in range(port_dep, port_fin+1):
 ports.append(p)

for port in ports:
 s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
 s.settimeout(1) 
 try:
  s.connect(("127.0.0.1", port))
  print "\nPort %d : \033[92mOK\033[0m" %port
 except socket_error as serr:
  if serr.errno == errno.ECONNREFUSED:
   print "\nPort %d : \033[92mOK\033[0m" %port
  else:
   print "\nPort %d : \033[91mFiltred\033[0m" %port

 s.close()

print " "

